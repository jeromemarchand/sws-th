# Sencor SWS TH2850-2999-3851-5150 Communication Protocol

## Introduction

SWS TH2850-2999-3851-5150 is a remote thermometer (-40°C - 60°C) and
hygrometer (20% - 95%) sensor. It communicates with the base on the
LPD433 band (low power device 433 MHz) at interval of about a minute
or two.  
The sensor can be set on one of three channel by a switch in
its battery compartment.

This document contains the result of my reverse engineering of the
communication protocol of this sensor. It may apply in full of
partially, to other weather station sensors.

## Encoding

Encoding is made by impulse length. I'll use the following value to
describe them:  
- 0 ~250 ms
- 1 ~500 ms
- 2 ~750 ms
- 3 ~1000 ms
- 4 ~2000 ms
- 5 ~2450 ms
- 6 ~3000 ms
- 7 ~3400 ms
- 8 ~4000 ms

Out of range values:
?xxx? = xxx ms

Here's what I recorded when the sensor is on channel 1

```
3131313131414131413131313131313141413141413131414141414131314131313141413131313131313131313131313131313181
3131313131414131413131313131313141413141413131414141414131314131313141413131313131313131313131313131313181
3131313131414131413131313131313141413141413131414141414131314131313141413131313131313131313131313131313181
3131313131414131413131313131313141413141413131414141414131314131313141413131313131313131313131313131313181
3131313131414131413131313131313141413141413131414141414131314131313141413131313131313131313131313131313181
3131313131414131413131313131313141413141413131414141414131314131313141413131313131313131313131313131313181
3131313131414131413131313131313141413141413131414141414131314131313141413131313131313131313131313131313181
3131313131414131413131313131313141413141413131414141414131314131313141413131313131313131313131313131313181
313131313141413141313131313131314141314141313141414141413131413131314141313131313131313131313131313131
5
222222220101010101101001010101100110100101100101100110010101100101011010100101011001011001
2222222201010101011010010101011001101001011001011001?410??343?01010110010101?350??391?10100101011001011001
222222220101010101101001010101100110100101100101100110010101100101011010100101011001011001
222222220101010101101001010101100110100101100101100110010101100101011010100101011001011001
222222220101010101101001010101100110100101100101100110010101100101011010100101011001011001
222222220101010101101001010101100110100101100101100110010101100101011010100101011001011001
Z22222220101010101101001010101100110100101100101100110010101100101011010100101011001011001
222222220101010101101001010101100110100101100101100110010101100101011010100101011001011001
222222220101010101101001010101100110100101100101100110010101100101011010100101011001011001
222222220101010101101001010101100110100101100101100110010101100101011010100101011001011001
222222220101010101101001010101100110100101100101100110010101100101011010100101011001011001
222222220101010101101001010101100110100101100101100110010101100101011010100101011001011001
222222220101010101101001010101100110100101100101100110010101100101011010100101011001011001
222222220101010101101001010101100110100101100101100110010101100101011010100101011001011001
2222?376?3220101010101101001010101100110100101100101100110010101100101011010100101011001011001
2z2222220101010101101001010101100110100101100101100110010101100101011010100101011001011001
222222220101010101101001010101100110100101100101100110010101100101011010100101011001011001
222222220101010101101001010101100110100101100101100110010101100101011010100101011001011001
222222220101010101101001010101100110100101100101100110010101100101011010100101011001011001
222222220101010101101001010101100110100101100101100110010101100101011010100101011001011001
222222220101010101101001010101100110100101100101100110010101100101011010100101011001011001
222222220101010101101001010101100110100101100101100110010101100101011010100101011001011001
222222220101010101101001010101100110100101100101100110010101100101011010100101011001011001
222222220101010101101001010101100110100101100101100110010101100101011010100101011001011001
22222222010101010110100101010110011010010110010110011001010110010101101010010101100101100
```

Chanel 2

```
31313131314141314131314131313131414131413141413141414141313141313141313131313131313131313131313131313131
813131313131414131413131413131313141413141314141314141414131314131314131313131313131313131313131313131313181
3131313131414131413131413131313141413141314141314141414131314131314131313131313131313131313131313131313181
3131313131414131413131413131313141413141314141314141414131314131314131313131313131313131313131313131313181
3131313131414131413131413131313141413141314141314141414131314131314131313131313131313131313131313131313181
3131313131414131413131413131313141413141314141314141414131314131314131313131313131313131313131313131313181
3131313131414131413131413131313141413141314141314141414131314131314131313131313131313131313131313131313181
3131313131414131413131413131313141413141314141314141414131314131314131313131313131313131313131313131313181
31313131314141314131314131313131414131413141413?640??1877?141414131314131314131313131313131313131313131313131313181
313131313141413141313141313131314141314131414131414141413131413131413131313131313131313131313131313131
?2380?
222222220101010101101001010110010110100101100101011001100101100101100101100101100110011001
222222220101010101101001010110010110100101100101011001100101100101100101100101100110011001
222222220101010101101001010110010110100101100101011001100101100101100101100101100110011001
Z22222220101010101101001010110010110100101100101011001100101100101100101100101100110011001
Zz222z220101010101101001010110010110100101100101011001100101100101100101100101100110011001
2z2222220101010101101001010110010110100101100101011001100101100101100101100101100110011001
222222220101010101101001010110010110100101100101011001100101100101100101100101100110011001
222zZz220101010101101001010110010110100101100101011001100101100101100101100101100110011001
Z22222220101010101101001010110010110100101100101011001100101100101100101100101100110011001
2222z2220101010101101001010110010110100101100101011001100101100101100101100101100110011001
222222220101010101101001010110010110100101100101011001100101100101100101100101100110011001
222222220101010101101001010110010110100101100101011001100101100101100101100101100110011001
222z22220101010101101001010110010110100101100101011001100101100101100101100101100110011001
222222220101010101101001010110010110100101100101011001100101100101100101100101100110011001
222zZz220101010101101001010110010110100101100101011001100101100101100101100101100110011001
222222220101010101101001010110010110100101100101011001100101100101100101100101100110011001
222222220101010101101001010110010110100101100101011001100101100101100101100101100110011001
22222zZz0101010101101001010110010110100101100101011001100101100101100101100101100110011001
Zz2222220101010101101001010110010110100101100101011001100101100101100101100101100110011001
222222220101010101101001010110010110100101100101011001100101100101100101100101100110011001
222222220101010101101001010110010110100101100101011001100101100101100101100101100110011001
222z22220101010101101001010110010110100101100101011001100101100101100101100101100110011001
Zz2z22220101010101101001010110010110100101100101011001100101100101100101100101100110011001
Z222222z010101010110100101011001011010010110010101100110010110010110010110010110011001100__
```

Chanel 3:

```
331313131314141314131413131313131414131413141414141414141313141313141313181
31313131314141314131413131313131414131413141414141414141313141313141313181
31313131314141314131413131313131414131413141414141414141313141313141313181
3131313131414131413141313131313141413141314141414141?1426??925?H1313141313141313181
3131313131414131413141313131313141413141314141414141414131314131314?359?313181
31313131314141314131413131313131414131413141414141414141313141313141313181
31313131314141314131413131313131414131413141414141414141313141313141313181
31313131314141314131413131313131414131413141414141414141313141313141313181
31313131314141314131413131313131414131413141414141414141313141313141313181
31313131314141314131413131313131414131413141414141414141313141313141313181
31313131314141314131413131313131414131413141414141414141313141313141313181
31313131314141314131413131313131414131413141414141414141313141313141315
222222220101010101101001010110100110100101100101011010100101100101100101100110010110101001
222222220101010101101001010110100110100101100101011010100101100101100101100110010110101001
222222220101010101101001010110100110100101100101011010100101100101100101100110010110101001
222222Zz01010101011010010?377??359?11010011010010110010100?645?010100101100101100101100110010110101001
222222220101010101101001010110100110100101100101011010100101100101100101100110010110101001
222222220101010101101001010110100110100101100101011010100101100101100101100110010110101001
222222220101010101101001010110100110100101100101011010100101100101100101100110010110101001
22222222010101010110100101011010011010010110010101101010010110010110010110011001.110101001
222222220101010101101001010110100110100101100101011010100101100101100101100110010110101001
222222220101010101101001010110100110100101100101011010100101100101100101100110010110101001
222222220101010101101001010110100110100101100101011010100101100101100101100110010110101001
222222220101010101101001010110100110100101100101011010100101100101100101100110010110101001
222222220101010101101001010110100110100101100101011010100101100101100101100110010110101001
222222220101010101101001010110100110100101100101011010100101100101100101100110010110101001
222222220101010101101001010110100110100101100101011010100101100101100101100110010110101001
222222220101010101101001010110100110100101100101011010100101100101100101100110010110101001
222222220101010101101001010110100110100101100101011010100101100101100101100110010110101001
222222220101010101101001010110100110100101100101011010100101100101100101100110010110101001
222222220101010101101001010110100110100101100101011010100101100101100101100110010110101001
222222220101010101101001010110100110100101100101011010100101100101100101100110010110101001
222222220101010101101001010110100110100101100101011010100101100101100101100110010110101001
222222220101010101101001010110100110100101100101011010100101100101100101100110010110101001
222222220101010101101001010110100110100101100101011010100101100101100101100110010110101001
22222222010101010110100101011010011010010110010101101010010110010110010110011001011010100_.
```

We can clearly see two different patterns. The sensor seems to
communicate in two different formats.  Between them, there is 2400 or
3400 ms pause (5 or 7). Mostly 2400 ms. It's probably not important.  
Longer impulses 3, 4 and 8 (1000, 2000 and 4000 ms) are always
followed by 1 (500ms)


## Dataframe of the first format (Celcius):

### Example

```
3131313141414141413131413131313141413131414131314141414131314141313131313131313131313131313131313131313181
3131313141414141413131413131313141413131414131314141414131314141313131313131313131313131313131313131313181
3131313141414141413131413131313141413131414131314141414131314141313131313131313131313131313131313131313181
3131313141414141413131413131313141413131414131314141414131314141313131313131313131313131313131313131313181
3131313141414141413131413131313141413131414131314141414131314141313131313131313131313131313131313131313181
3131313141414141413131413131313141413131414131314141414131314141313131313131313131313131313131313131313181
3131313141414141413131413131313141413131414131314141414131314141313131313131313131313131313131313131313181
3131313141414141413131413131313141413131414131314141414131314141313131303131313131313131313131313131313181
3131313141414141413131413131313141413131414131314141414131314141313131313131313131313131313131313131315
```

### Description

Looks like a long and a short impulse encode one bit (31 -> 0, 41 ->
1) An even longer impulse followed by a short one seems to be used
for syncing (81). The dataframe is repeated about 10 times.

This dataframe is 52 bits. Bits 24-27 seems to be always on. Last 16
bits seems to be always 0. I can also detect unknown sensors from
my neighbors with what seems the same format, but only 36 bits. At
least it give coherent temperature and humidity values.

```
0    4    8    12   16   20   24   28   32   36   40   44   48
0000 0110 1000 0000 1100 0011 1111 0010 1110 0000 0000 0000 0000
^ Ident ^ H?ch ^    TempC   ^ ?15? ^ Hum % ^ ^ ???? (Always 0) ^
```

First 8 bits seems to be some kind of identifier. It's the same in
both formats of dataframe.

Bit 8 seems to be the battery charge signal. It's usually on, but
become 0 when the battery voltage is low (a bit above 1V).

The channel is encoded on bits 10-11. It's starts from zero and it
needs to be incremented by 1 to match the value on the switch or the
displayed on the base.

Temperature is located at bits 12-23. It is a 12 bits signed integer
and the temperature is in decidegree Celcius. There is possibly some
special value when out-of-range (-20C - 60C).

Humidity is located at bits 28-35. It is measured in percents. There
might be some special values for low and high humidity out of the
measuring range (20% - 95%). However, it seems the sensor sends value
lower than 20% (down to 15% at least), but the base show LL in that
case. So maybe we should just disregard number out of the reliable
range and just consider the value to be high or low.

The sensor should also be able to send a low battery signal. I wasn't
able to decode it yet.

## Dataframe of the second format (Fahrenheit):

Dataframe is synchronized by a repeating 8 x 750ms impulse (22222222)
It is 82 impulses long (without sync).

```
1: 0101010101101001010101100110100101100101100110010101100101011010100101011001011001
2: 0101010101101001010110010110100101100101011001100101100101100101100101100110011001
3: 0101010101101001010110100110100101100101011010100101100101100101100110010110101001
```

It looks like its a sequence of 01 and 10. 01 is 0 and 10 is 1 (how is
that encoding called?). That makes the data frame 41 bits long, which
is odd. Maybe the last 500ms impulse is part of the synchronization.
The dataframe is repeated about 25 times.

```
0    4	  8    12   16   20   24   28   32   36   40
0000 1111 0011 0110 0111 1110 0010 0010 1110 0101 0
? Ident ? L?ch ^ Tf*10+900  ^ ^ Hum % ^   ?    ?  ?
```

First 8 bits are the same identifier as in the first format.  Low
power seems to be encoded on bit 8. Its value is reverse to what it is
on the celcius format. The channel is encoded on bits 10-11. It
matches the value on the sensor switch or the base.

Temperature is located at bits 12-23. It is encoded in decidegree
Fahrenheit with a 90°F offset on 12 bits. Humidity is at bits
24-31. It is measured in percents.
